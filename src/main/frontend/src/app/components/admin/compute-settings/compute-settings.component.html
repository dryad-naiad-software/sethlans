<div class="row pb-5">
  <div class="col-md-10 m-auto">
    <div class="card">
      <div class="card-header">
        <h2>Compute Settings</h2>
      </div>
      <div class="card-body table-responsive">
        <table class="table table-striped">
          <thead>
          <h5>Active Compute Settings</h5>
          </thead>
          <tbody>
          <tr>
            <td>Compute Method</td>
            <td>{{currentNode.computeMethod}}</td>
          </tr>
          <tr *ngIf="currentNode.computeMethod !== computeMethodEnum.GPU">
            <td>Rendering Cores</td>
            <td>{{currentNode.cores}}</td>
          </tr>
          <tr *ngIf="currentNode.computeMethod !== computeMethodEnum.GPU">
            <td>Tile Size: CPU</td>
            <td>{{currentNode.tileSizeCPU}}</td>
          </tr>
          <tr *ngIf="currentNode.computeMethod !== computeMethodEnum.CPU">
            <td>Selected GPU(s)</td>
            <td>
              <ul class="list-unstyled">
                <li *ngFor="let gpu of currentNode.selectedGPUs"> {{gpu.model}}</li>
              </ul>
            </td>
          </tr>
          <tr *ngIf="currentNode.computeMethod !== computeMethodEnum.CPU">
            <td>Tile Size: GPU</td>
            <td>{{currentNode.tileSizeGPU}}</td>
          </tr>
          </tbody>
        </table>
        <hr/>
        <h5>Update Compute Settings</h5>
        <form #updateComputeForm="ngForm" class="editForm">
          <div class="form-group" ngbTooltip="Render with either a CPU/GPU or ability to use either one."
               placement="left">
            <label for="computeMethod">Compute Method Selection</label>
            <select class="form-control form-control-sm"
                    id="computeMethod"
                    name="computeMethod"
                    value="{{currentNode.getComputeMethod()}}"
                    #computeMethod="ngModel"
                    (change)="methodSelection()"
                    [(ngModel)]="newNode.computeMethod">
              <option *ngFor="let method of availableComputeMethods">{{method}}</option>
            </select>
          </div>
          <div *ngIf="newNode.computeMethod !== computeMethodEnum.GPU">
            <hr/>
            <h6>CPU Settings:</h6>
            <div class="form-group" *ngIf="newNode.computeMethod !== computeMethodEnum.GPU"
                 ngbTooltip="Number of CPU cores to be used for rendering." placement="left">
              <label for="cores">Rendering Cores:</label>
              <mat-slider
                id="cores"
                min="1"
                step="1"
                thumb-label="true"
                [max]="totalCores"
                #cores="ngModel"
                value="{{currentNode.getCores()}}"
                name="cores"
                [(ngModel)]="newNode.cores"></mat-slider>
            </div>
            <div class="form-group" *ngIf="newNode.computeMethod !== computeMethodEnum.GPU"
                 ngbTooltip="Tile size used for CPU rendering." placement="left">
              <label for="tileSizeCPU">CPU Render Tile Size:</label>
              <input type="number"
                     class="form-control form-control-sm"
                     name="tileSizeCPU"
                     id="tileSizeCPU"
                     value="{{currentNode.getTileSizeCPU()}}"
                     #tileSizeCPU="ngModel"
                     [(ngModel)]="newNode.tileSizeCPU">
            </div>
          </div>
          <div *ngIf="newNode.computeMethod !== computeMethodEnum.CPU">
            <hr/>
            <h6>GPU Settings:</h6>
            <br/>
            <div class="form-group" *ngIf="newNode.computeMethod !== computeMethodEnum.CPU"
                 ngbTooltip="GPU devices to be used for rendering." placement="left">
              <label>GPU Devices:</label>
              <div *ngFor="let gpu of availableGPUs">
                <input type="checkbox"
                       class="form-control-sm"
                       name="{{gpu.model}}"
                       value="{{gpu.model}}"
                       #gpuSelection
                       required
                       [checked]="gpu.selected"
                       (change)="selected($event, gpu)"/>
                <label class="form-check-label form-control-sm">{{gpu.model}}</label>
              </div>
            </div>
            <div class="form-group" *ngIf="newNode.computeMethod !== computeMethodEnum.CPU"
                 ngbTooltip="Tile size used for GPU rendering." placement="left">
              <label for="tileSizeGPU">GPU Render Tile Size:</label>
              <input type="number"
                     class="form-control form-control-sm"
                     name="tileSizeGPU"
                     id="tileSizeGPU"
                     value="{{currentNode.getTileSizeGPU()}}"
                     #tileSizeCPU="ngModel"
                     [(ngModel)]="newNode.tileSizeGPU">
            </div>
          </div>
          <nav class="pt-2">
            <input [disabled]="!updateComputeForm.valid"
                   type="submit"
                   value="Save Changes"
                   class="btn btn-outline-dark float-right">
            <button class="btn btn-outline-secondary" (click)="cancel()">Cancel</button>
          </nav>
        </form>
        <!--<div>-->
        <!--Debugging:-->
        <!--<pre>{{ newNode | json }}</pre>-->
        <!--</div>-->
      </div>
    </div>
  </div>
</div>
