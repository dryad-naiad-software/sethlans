<div *ngIf="nodeWizardScreen == false" class="row pb-1">
  <div class="col-md-10 m-auto">
    <div class="card">
      <div class="card-header">
        <div class="row">
          <div class="col-md-8">
            <h4 style="font-family: 'Fjalla One', sans-serif">Nodes</h4>
          </div>
          <div class="col-md-4">
            <button (click)="startNodeWizard()" class="ml-2 btn btn-outline-dark float-end">
              <fa-icon [icon]="faPlus"></fa-icon>
              <span class="ms-2">Add Node(s)</span>
            </button>
            <!--            <button class="btn btn-outline-dark float-end me-2">-->
            <!--              <fa-icon [icon]="faDownload"></fa-icon>-->
            <!--              <span class="ms-2">Get Logs</span>-->
            <!--            </button>-->
          </div>
        </div>
      </div>
      <div class="card-body">
        <div class="col-md-12 m-auto">
          <table [dataSource]="nodeDataSource" cdk-table class="table table-responsive-md">
            <ng-container cdkColumnDef="status">
              <th *cdkHeaderCellDef cdk-header-cell>Status</th>
              <td *cdkCellDef="let node" cdk-cell>
                <span *ngIf="node.active" class="text-success">Active</span>
                <span *ngIf="node.active == false" class="text-warning">Paused</span>
              </td>
            </ng-container>
            <ng-container cdkColumnDef="hostname">
              <th *cdkHeaderCellDef cdk-header-cell>Hostname</th>
              <td *cdkCellDef="let node" cdk-cell>{{node.hostname}}</td>
            </ng-container>
            <ng-container cdkColumnDef="ipAddress">
              <th *cdkHeaderCellDef cdk-header-cell>IP Address</th>
              <td *cdkCellDef="let node" cdk-cell>{{node.ipAddress}}</td>
            </ng-container>
            <ng-container cdkColumnDef="port">
              <th *cdkHeaderCellDef cdk-header-cell>Port</th>
              <td *cdkCellDef="let node" cdk-cell>{{node.networkPort}}</td>
            </ng-container>
            <ng-container cdkColumnDef="os">
              <th *cdkHeaderCellDef cdk-header-cell>OS</th>
              <td *cdkCellDef="let node" cdk-cell>{{node.os}}</td>
            </ng-container>
            <ng-container cdkColumnDef="compute">
              <th *cdkHeaderCellDef cdk-header-cell>Compute</th>
              <td *cdkCellDef="let node" cdk-cell>{{node.nodeType}}</td>
            </ng-container>
            <ng-container cdkColumnDef="cpu">
              <th *cdkHeaderCellDef cdk-header-cell>CPU</th>
              <td *cdkCellDef="let node" cdk-cell>{{node.cpu.name}}</td>
            </ng-container>
            <ng-container cdkColumnDef="cores">
              <th *cdkHeaderCellDef cdk-header-cell>Core(s)</th>
              <td *cdkCellDef="let node" cdk-cell>{{node.selectedCores}}</td>
            </ng-container>
            <ng-container cdkColumnDef="gpus">
              <th *cdkHeaderCellDef cdk-header-cell>GPU(s)</th>
              <td *cdkCellDef="let node" cdk-cell>
                <span *ngFor="let gpu of node.selectedGPUs">{{gpu.model}}<br/></span>
              </td>
            </ng-container>
            <ng-container cdkColumnDef="slots">
              <th *cdkHeaderCellDef cdk-header-cell>Slots</th>
              <td *cdkCellDef="let node" cdk-cell>{{node.totalRenderingSlots}}</td>
            </ng-container>
            <ng-container cdkColumnDef="benchmarkStatus">
              <th *cdkHeaderCellDef cdk-header-cell>Benchmark State</th>
              <td *cdkCellDef="let node" cdk-cell>
                <span *ngIf="!node.benchmarkPending && !node.benchmarkComplete" class="text-warning">Waiting</span>
                <span *ngIf="node.benchmarkPending" class="text-info">In Progress</span>
                <span *ngIf="node.benchmarkComplete" class="text-success">Complete</span>
              </td>
            </ng-container>
            <ng-container cdkColumnDef="actions">
              <th *cdkHeaderCellDef cdk-header-cell></th>
              <td *cdkCellDef="let node" cdk-cell>
                <div class="btn-group-vertical">
                  <button *ngIf="!node.active" class="btn btn-outline-success btn-sm"
                          type="button">
                    Enable
                  </button>
                  <button *ngIf="node.active" class="btn btn-outline-warning btn-sm"
                          type="button">
                    Disable
                  </button>
                  <button class="btn btn-outline-danger btn-sm" type="button">
                    Delete
                  </button>
                </div>
              </td>
            </ng-container>
            <!-- Header and Row Declarations -->
            <tr *cdkHeaderRowDef="nodeDisplayedColumns.value" cdk-header-row></tr>
            <tr *cdkRowDef="let row; columns: nodeDisplayedColumns.value" cdk-row></tr>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
<div *ngIf="nodeWizardScreen" class="row pb-1">
  <div class="col-md-8 m-auto">
    <div class="card">
      <div class="card-header">
        <div class="row">
          <div class="col-md-8">
            <h4 style="font-family: 'Fjalla One', sans-serif">Add Node Wizard</h4>
          </div>
        </div>
      </div>
      <div class="card-body">
        <ul class="nav nav-tabs justify-content-between pb-3">
          <li>
            <button [ngClass]="nodeWizardProgress == NodeWizardProgress.START
                      ? 'btn-outline-primary' : 'btn-outline-dark'"
                    class="btn btn-lg btn-circle"
                    type="button">
              <fa-icon [icon]="faFlagCheckered"></fa-icon>
            </button>
          </li>
          <li>
            <button [ngClass]="nodeWizardProgress == NodeWizardProgress.ADD
                      ? 'btn-outline-primary' : 'btn-outline-dark'"
                    class="btn btn-lg btn-circle"
                    type="button">
              <fa-icon [icon]="faPlus"></fa-icon>
            </button>
          </li>
          <li>
            <button [ngClass]="nodeWizardProgress == NodeWizardProgress.SUMMARY
                      ? 'btn-outline-primary' : 'btn-outline-dark'"
                    class="btn btn-lg btn-circle"
                    type="button">
              <fa-icon [icon]="faRectangleList"></fa-icon>
            </button>
          </li>
          <li>
            <button [ngClass]="nodeWizardProgress == NodeWizardProgress.FINISHED
                      ? 'btn-outline-success' : 'btn-outline-secondary'"
                    class="btn btn-lg btn-circle"
                    type="button">
              <fa-icon [icon]="faCheck"></fa-icon>
            </button>
          </li>
        </ul>
        <div *ngIf="nodeWizardProgress == NodeWizardProgress.START" class="pt-2">
          <div class="alert alert-info" role="alert">
            <p class="mb-0 text-center">Server API Key:<span class="ms-2"><strong>{{sethlansAPIKey}}</strong></span>
              <button (click)="copyAPIKey()" class="ms-2 btn btn-outline-secondary btn-sm"
                      ngbTooltip="Copy to Clipboard" placement="top">
                <fa-icon [icon]="faClipboard"></fa-icon>
              </button>
            </p>
          </div>
          <h6>Which action would you like to perform?</h6>
          <div class="col-md-4 ms-1">
            <div class="form-check" ngbTooltip="Scan LAN for Nodes" placement="left">
              <label class="form-check-label">
                <input [(ngModel)]="nodeWizardType"
                       [value]="NodeWizardType.SCAN"
                       class="form-check-input"
                       name="type"
                       required
                       type="radio">Scan LAN for Node(s)
              </label>
            </div>
            <div class="form-check" ngbTooltip="Add Nodes via IP Address and Port" placement="left">
              <label class="form-check-label">
                <input [(ngModel)]="nodeWizardType"
                       [value]="NodeWizardType.MANUAL"
                       class="form-check-input"
                       name="type"
                       required
                       type="radio">Add Node(s)
              </label>
            </div>
          </div>
        </div>
        <div *ngIf="nodeWizardProgress == NodeWizardProgress.ADD">
          <div *ngIf="nodeWizardType == NodeWizardType.SCAN" class="pt-2">
            <div *ngIf="scanning" class="alert alert-info text-center" role="alert">
              <span>Scanning for Sethlans Nodes on LAN</span>
              <div aria-hidden="true" class="ms-2 spinner-border spinner-border-sm text-center" role="status"></div>
            </div>
          </div>
          <div *ngIf="!scanning">
            <table class="table table-responsive-md">
              <thead>
              <tr>
                <th colspan="col">Hostname</th>
                <th colspan="col">IP Address</th>
                <th colspan="col">Port</th>
                <th colspan="col">OS</th>
                <th colspan="col">Compute</th>
                <th colspan="col">CPU</th>
                <th colspan="col">Core(s)</th>
                <th colspan="col">GPU(s)</th>
                <th colspan=""></th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let node of networkNodeList">
                <td>{{node.hostname}}</td>
                <td>{{node.ipAddress}}</td>
                <td>{{node.networkPort}}</td>
                <td>{{node.os}}</td>
                <td>{{node.nodeType}}</td>
                <td>{{node.cpu.name}}</td>
                <td>{{node.selectedCores}}</td>
                <td><span *ngFor="let gpu of node.selectedGPUs">{{gpu.model}}<br/></span></td>
                <td>
                  <button (click)="addNode(node, $event)"
                          class="btn btn-primary">Select
                  </button>
                </td>
              </tr>
              </tbody>
            </table>

          </div>
          <div *ngIf="nodeWizardType == NodeWizardType.MANUAL">
            Manual
          </div>
        </div>
        <div
          *ngIf="nodeWizardProgress == NodeWizardProgress.SUMMARY || nodeWizardProgress == NodeWizardProgress.FINISHED">
          <div *ngIf="nodeWizardProgress == NodeWizardProgress.FINISHED">
            <div class="alert alert-success text-center" role="alert">
              <span>Adding Selected Nodes to the Server</span>
              <div aria-hidden="true" class="ms-2 spinner-border spinner-border-sm text-center" role="status"></div>
            </div>
          </div>
          <h4 class="pt-2 pb-2">Selected Nodes:</h4>
          <table class="table table-responsive-md">
            <thead>
            <tr>
              <th colspan="col">Hostname</th>
              <th colspan="col">IP Address</th>
              <th colspan="col">Port</th>
              <th colspan="col">OS</th>
              <th colspan="col">Compute</th>
              <th colspan="col">CPU</th>
              <th colspan="col">Core(s)</th>
              <th colspan="col">GPU(s)</th>
              <th colspan=""></th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let node of selectedNodeList">
              <td>{{node.hostname}}</td>
              <td>{{node.ipAddress}}</td>
              <td>{{node.networkPort}}</td>
              <td>{{node.os}}</td>
              <td>{{node.nodeType}}</td>
              <td>{{node.cpu.name}}</td>
              <td>{{node.selectedCores}}</td>
              <td><span *ngFor="let gpu of node.selectedGPUs">{{gpu.model}}<br/></span></td>
              <td>
                <button (click)="removeNode(node)"
                        class="btn btn-danger">Remove
                </button>
              </td>
            </tr>
            </tbody>
          </table>
        </div>

      </div>
      <div class="card-footer">
        <button (click)="cancelNodeWizard()"
                *ngIf="nodeWizardProgress == NodeWizardProgress.START"
                class="btn btn-outline-dark float-start">Cancel
        </button>
        <button (click)="previous()"
                *ngIf="nodeWizardProgress != NodeWizardProgress.START"
                class="btn btn-outline-dark float-start">Previous
        </button>
        <button (click)="next()"
                *ngIf="nodeWizardProgress != NodeWizardProgress.SUMMARY
        && nodeWizardProgress != NodeWizardProgress.FINISHED"
                [disabled]="nextDisabled"
                class="btn btn-outline-primary float-end">Next
        </button>
        <button (click)="submitNodes()"
                *ngIf="nodeWizardProgress == NodeWizardProgress.SUMMARY"
                [disabled]="submitDisabled"
                class="btn btn-outline-primary float-end">Submit Node(s) to Server
        </button>
      </div>
    </div>
  </div>
</div>

<!--<div>-->
<!--  Debugging:-->
<!--<pre>{{ nodeList | json }}</pre>-->
<!--  <pre>{{networkNodeList | json}}</pre>-->
<!--  <pre>{{selectedNodeList | json}}</pre>-->
<!--  <pre>{{nodeFormList | json}}</pre>-->
<!--</div>-->
